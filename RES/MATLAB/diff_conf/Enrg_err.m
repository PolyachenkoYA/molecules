%dt = [10000,        9828,        9660,        9494,        9331,        9171,        9013,        8859,        8707,        8557,        8410,        8266,        8124,        7985,        7848,        7713,        7581,        7450,        7323,        7197,        7073,        6952,        6833,        6715,        6600,        6487,        6375,        6266,        6158,        6053,        5949,        5847,        5746,        5648,        5551,        5456,        5362,        5270,        5179,        5091,        5003,        4917,        4833,        4750,        4668,        4588,        4510,        4432,        4356,        4281,        4208,        4136,        4065,        3995,        3926,        3859,        3793,        3728,        3664,        3601,        3539,        3478,        3418,        3360,        3302,        3245,        3190,        3135,        3081,        3028,        2976,        2925,        2875,        2826,        2777,        2730,        2683,        2637,        2591,        2547,        2503,        2460,        2418,        2377,        2336,        2296,        2256,        2218,        2179,        2142,        2105,        2069,        2034,        1999,        1964,        1931,        1898,        1865,        1833,        1802,        1771,        1740,        1710,        1681,        1652,        1624,        1596,        1569,        1542,        1515,        1489,        1464,        1438,        1414,        1389,        1366,        1342,        1319,        1297,        1274,        1252,        1231,        1210,        1189,        1169,        1149,        1129,        1109,        1090,        1072,        1053,        1035,        1017,        1000,         983,         966,         949,         933,         917,         901,         886,         871,         856,         841,         827,         812,         798,         785,         771,         758,         745,         732,         720,         707,         695,         683,         672,         660,         649,         638,         627,         616,         605,         595,         585,         575,         565,         555,         546,         536,         527,         518,         509,         500,         492,         483,         475,         467,         459,         451,         443,         436,         428,         421,         414,         406,         399,         393,         386,         379,         373,         366,         360,         354,         348,         342,         336,         330,         325,         319,         314,         308,         303,         298,         293,         288,         283,         278,         273,         268,         264,         259,         255,         250,         246,         242,         238,         234,         230,         226,         222,         218,         214,         211,         207,         203,         200,         196,         193,         190,         186,         183,         180,         177,         174,         171,         168,         165,         162,         160,         157,         154,         152,         149,         146,         144,         141,         139,         137,         134,         132,         130,         127,         125,         123,         121,         119,         117,         115,         113,         111,         109,         107,         105,         104,         102,         100,          98,          97,          95,          93,          92,          90,          89,          87,          86,          84,          83,          81,          80,          78,          77,          76,          75,          73,          72,          71,          70,          68,          67,          66,          65,          64,          63,          62,          61,          59,          58,          57,          56,          55,          54,          53,          52,          51,          50,          49,          48,          47,          46,          45,          44,          43,          42, 41,    40,          39,          38,          37,          36,          35,          34,          33,          32,          31,          30,          29,          28,          27,          26,          25,          24,          23,          22,          21,          20,          19,          18,          17,          16];
dt = [758,         745,         732,         720,         707,         695,         683,         672,         660,         649,         638,         627,         616,         605,         595,         585,         575,         565,         555,         546,         536,         527,         518,         509,         500,         492,         483,         475,         467,         459,         451,         443,         436,         428,         421,         414,         406,         399,         393,         386,         379,         373,         366,         360,         354,         348,         342,         336,         330,         325,         319,         314,         308,         303,         298,         293,         288,         283,         278,         273,         268,         264,         259,         255,         250,         246,         242,         238,         234,         230,         226,         222,         218,         214,         211,         207,         203,         200,         196,         193,         190,         186,         183,         180,         177,         174,         171,         168,         165,         162,         160,         157,         154,         152,         149,         146,         144,         141,         139,         137,         134,         132,         130,         127,         125,         123,         121,         119,         117,         115,         113,         111,         109,         107,         105,         104,         102,         100,          98,          97,          95,          93,          92,          90,          89,          87,          86,          84,          83,          81,          80,          78,          77,          76,          75,          73,          72,          71,          70,          68,          67,          66,          65,          64,          63,          62,          61,          59,          58,          57,          56,          55,          54,          53,          52,          51,          50,          49,          48,          47,          46,          45,          44,          43,          42, 41,    40,          39,          38,          37,          36,          35,          34,          33,          32,          31,          30,          29,          28,          27,          26,          25,          24,          23,          22,          21, 20, 19,18,17,16];
% dt >= 15 is bad, but I have dt 15,14,13,12,11,10 avaliable
% after dt < 758 numeric error comes in

N = length(dt);
sgmE = zeros(1,N);
for i = 1:N
    Fname = ['./DATA/dt_N100_VR/dt_' num2str(dt(i)) '/'];
    E = dlmread([Fname 'E.txt']);
    params = read_params([Fname 'param.dat']);    
    %dE = (E(:,3)/E(1,3)-1) ./ (params.Ntot*params.Ntot);
    dE = (E(:,3)/E(1,3)-1);
    sgmE(i) = std(dE);
    disp([num2str(round(i/N*100)) ' %']);
end

x = log(1./dt)/log(10);
y = log(sgmE)/log(10);
p = polyfit(x,y,1);
x_line = [min(x), max(x)];
plot(x, y, x_line, polyval(p,x_line));
grid on;
title(['k = ' num2str(p(1))]);
xlabel('log10(dt)');
ylabel('log10(dE)');
